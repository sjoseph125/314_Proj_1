---
title: '[Unit 2 Project Template/Name your project here]'
authors: 'Samson Joseph, Sean Simmons, Daniel Gurwah, Joseph Difrancesco'
date: "null"
output:
  html_document:
    df_print: paged
---
## Delete lines 8 - 16 section before submitting the file
This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook to use as a template for your Unit 2 Project. 

Add new chunks by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).  You may need to Knit to HTML, using the KNIT button on the toolbar. 

You will submit both the saved R Markdown file (.RMD) WITH A NEW NAME and the HTML file.
## Delete lines 8-16 before submitting the file.

**To:** [Add Name here and remove brackets]

**From:**[Add Team Members names here and remove brackets ]

**Subject:** [Add Subject here and remove brackets]


## Background
[Provide a brief (one paragraph, please that 1) recaps the key features of your dataset, 2) states your task as a follow-up of your previous data exploration.  You may use a table to summarize your dataset features, if you wish.]

```{r setup, include =FALSE}
#Loading Libraries
library(tidyverse)
#library(inference)
library(statsr)
#Loading Dataset
vgs <- read.csv('replaced variables.csv')

#Transforming variables to appropriate data types
vgs$NA_Sales<-as.numeric(vgs$NA_Sales)
vgs$EU_Sales<-as.numeric(vgs$EU_Sales)
vgs$JP_Sales<-as.numeric(vgs$JP_Sales)
vgs$Other_Sales<-as.numeric(vgs$Other_Sales)
vgs$Platform <- as.factor(vgs$Platform)
vgs$Publisher <- as.factor(vgs$Genre)
vgs$Genre <- as.factor(vgs$Genre)
vgs$Developer <- as.factor(vgs$Developer)
vgs$Rating <- as.factor(vgs$Rating)
vgs$Year_of_Release <- as.factor(vgs$Year_of_Release)
vgs$User_Score <- as.numeric(vgs$User_Score)
vgs$Name <- as.character(vgs$Name)
vgs$User_Score <- vgs$User_Score * 10

#Replacing empty entries with NA
vgs$Rating[vgs$Rating %in% c("")]<- NA
vgs$Rating <-factor(vgs$Rating)
vgs$Developer[vgs$Developer %in% c("")]<- NA
vgs$Developer <-factor(vgs$Developer)
vgs$Genre[vgs$Genre %in% c("")]<- NA
vgs$Genre <-factor(vgs$Genre)
vgs <- filter(vgs, Name != "")
```
## Inference Analyses

### Analysis 1: One Mean -[NA_Sales]
#### Analyst:[Sean Simmons]

[Put text of analysis here and add as many code chunks and text sections as you need.]

```{r}
#v1
###CHOOSE ONE OF THESE TESTS TO INTERPRET NORMALITY
#extract the NA_sales variable w/ NA observations removed
global_sub_2016 <- subset(vgs$Global_Sales)
global_2016 <- sum(global_sub_2016)
#view / check new variable: NA_sales1w
view(NA_sales1) 
summary(NA_sales1)
#histogram visualization
ggplot() + geom_histogram(mapping = aes(x = NA_sales1), binwidth = .1) + xlim(0, 10)
#density plot visualization
ggplot() + geom_density(mapping = aes(x = NA_sales1))
#quantile plot
qqnorm(NA_sales1)
qqline(NA_sales1)
###+++++++++++++++++
### T test
t.test(NA_sales1, conf.level = 0.95) # to produce a confidence interval
### not working
#inference(NA_sales1, est = 'mean', type = 'ci', method = 'theoretical')
summary(vgs$Global_Sales) #summarizing global sales to get population mean for null hypothesis

t.test(NA_sales1, mu = 217900
)
```
```{r}
#v2
###CHOOSE ONE OF THESE TESTS TO INTERPRET NORMALITY
#extract the NA_sales variable w/ NA observations removed
global_sub_2016 <- subset(vgs$Global_Sales, vgs$Year_of_Release == "2016","")
global_2016 <- sum(global_sub_2016)
#view / check new variable: NA_sales1w
view(NA_sales1) 
summary(NA_sales1)
#histogram visualization
ggplot() + geom_histogram(mapping = aes(x = NA_sales1), binwidth = .1) + xlim(0, 10)
#density plot visualization
ggplot() + geom_density(mapping = aes(x = NA_sales1))
#quantile plot
qqnorm(NA_sales1)
qqline(NA_sales1)
###+++++++++++++++++
### T test
t.test(NA_sales1, conf.level = 0.95) # to produce a confidence interval
### not working
#inference(NA_sales1, est = 'mean', type = 'ci', method = 'theoretical')
summary(vgs$Global_Sales) #summarizing global sales to get population mean for null hypothesis

t.test(NA_sales1, mu = 217900
)

```


### Analysis 2: One Proportion - Genre
#### Analyst:Daniel Gurwah

The parameter I investigated was the categorical variable genre. For the purpose of our test the category "fighting" in the genre variable was used as a success and the rest of them were counted as failures. There were 849 successes, which is about 5.1% of the sample size. There were 15868 failures, which is about 94.9% of the sample size. After calculating a confidence interval, I am 90% confident that fighting games make up **4.8% to 5.4%** of the video game population. 
```{r}
#recording the genre variable, success is a fighting game
genre_recode <- c(rep("success", 849), rep("failure", 15868))

#checking to make sure recoded properly
table(genre_recode)

#getting the 90% confidence interval
prop.test(x = 849, n = 16717, conf.level = .90)$conf.int
```


#source: https://www.statista.com/statistics/189592/breakdown-of-us-video-game-sales-2009-by-genre/

For the hypothesis test the question to answer is: Is the proportion of fighting video games sold from 1980 to 2020 (5.1%) different than the proportion of video games sold in 2018 (7.8)?
null hypothesis: Fighting games make up 7.8% of the population of video games
alternative hypothesis: fighting games do not make up 7.8% of the population of video games
We would like to test this at a 10% significance level.
Since the p-value is very small, we will reject the null hypothesis at a significance level of 10% where fighting games **do not** make up *7.8%* of the video game population. 
```{r}
#hyothesis test
prop.test(x = 849, n = 16717, p = 0.078, alternative = "two.sided")$p.value
```




### Analysis 3: Two Proportions - [Name or description of your Variables]
#### Analyst:[Name of Team Member]

[Put text of analysis here and add as many code chunks and text sections as you need.]

```{r}

```




### Analysis 4:Two Independent Means - [Name or description of your Variable]
#### Analyst:[Christopher Aguila]

[Put text of analysis here and add as many code chunks and text sections as you need.]

```{r}
nasplt <- vgs %>%
  select(NA_Sales, Platform) %>%
  filter(!is.na(NA_Sales)) %>%
  filter(Platform == "PS3" | Platform == "X360")

ggplot(data = nasplt, mapping = aes(x = Platform, y = NA_Sales)) +
  geom_boxplot()

ggplot(nasplt, aes(x=NA_Sales, color=Platform)) +
    geom_density()
```




### Analysis 5: Paired Data - NA_Sales and EU_Sales
#### Analyst: Samson Joseph

The variables chosen for this analysis are NA_Sales and EU_Sales. These two are quantitative variables that are paired because of different geographic regions. They are paired because we are trying to analyze the sales of the same games in different regions. We will be measuring the difference, or lack there of, of video game sales in these two regions. Then the explanatory variable is the region, and the response is the number of sales. In order to find the 95% confidence interval, we need to make sure we can use the CLT. The values are independent, since the sale of one game does not really affect the sale of another. The values were randomly chosen, and the dataset contains less than 10% of all video games sold.We get a confidence interval of approximately (0.1129 , 0.1567). In other words, we are 95% confident that the true difference between the sales of video games in North America and the EU is between 112,900 and 156,700, since the sales in the dataset are in the millions. Suggesting that more video games are sold in North America than in the EU.

Since the shapiro test returned a p-value much less than 0.05, we need to use the t-distribution for the hypothesis test.There is a possibility the difference we got was simply due to chance, and in fact the number of sales should be the same. So we can do a hypothesis test, with a null and alternative hypotheses. The null will be, the true difference between North America and the EU is 0, and the alternative will be the true difference not being 0. This is a two-tail test, since the alternative hypothesis says the true difference is not equal to 0, instead of either greater than or less than the null value which would require a one-tail test. After doing the t-test, we get a t-value of about 12 and a p-value of 2.2e-16. That p-value is extremely smaller than our significance value of 0.05. This means we should reject the null hypothesis. Since the probability of getting the observed mean of about 0.13, given the null hypothesis, is much smaller than 0.05.

Given the analysis of paired means, NA_Sales and EU_Sales, we can conclude that more games are sold in North America than in the European Union.This conclusion is corroborated by the 95% confidence interval and the hypothesis test. Both suggest a true difference that is positive, in favor favor of North America.

```{r warning=FALSE}
#Setting up necessary Dataframes.
#Randomly sampled 10,000 values from NA_Sales and EU_Sales so we could find the difference without any errors due to row lengths.
EU_Sales_A5 <- data.frame(EU_Sales=vgs$EU_Sales[!is.na(vgs$EU_Sales)])
EU_Sales_A5 <- data.frame(sample_n(EU_Sales1, 10000), replace=FALSE)
NA_sales_A5 <- data.frame(NA_Sales=NA_sales1)
NA_sales_A5<-data.frame(sample_n(NA_sales2, 10000), replace=FALSE)

#Creating boxplots to view the spread of the data in both dataframes.
#They y values are limited from 0 to 0.42 because 0.42 is the cutoff for outliers in NA_Sales. The same value was used for the EU_Sales boxplot to help compare the two datasets.  
ggplot(EU_Sales_A5, aes(x='',EU_Sales), ) + geom_boxplot() + ylim(0,.42) + ylab('EU Sales')
ggplot(NA_sales_A5,aes(x='',NA_Sales)) + geom_boxplot() + ylim(0,.42) +ylab('NA Sales')

#Creating a new dataframe to create a Diff column, with the difference between NA_Sales and EU_Sales
NA_EU_Sales <- data.frame(NA_Sales=NA_sales_A5$NA_Sales, EU_Sales=EU_Sales_A5$EU_Sales) 
NA_EU_Sales$Diff <- NA_EU_Sales$NA_Sales - NA_EU_Sales$EU_Sales

#Creating a histogram to see the spread of the Diff column
ggplot(NA_EU_Sales, aes(x=Diff)) + 
  geom_histogram(binwidth = .1) + xlim(-5,7)

#Testing for normality
shapiro.test(sample(NA_EU_Sales$Diff,5000, replace=FALSE))
qqnorm(NA_EU_Sales$Diff)
qqline(NA_EU_Sales$Diff)

#Creating a 95% confidence interval
inference(Diff, data=NA_EU_Sales, statistic = 'mean', type = 'ci', method = 'theoretical')

#Doing a t-test for the difference in the means.
t.test(NA_EU_Sales$NA_Sales, NA_EU_Sales$EU_Sales, paired = TRUE, alternative = 'two.sided')

```





## Recommendations

[Add text section with your recommendations here. In this section, you will briefly  summarize the conclusions of your estimates and tests. What statistically significant findings did you have?  What limitations are there in your findings?  Discuss if/how this is relevant in the context of your data – does it give us new insights ? Help us to better understand some phenomenon?  Or not?]


